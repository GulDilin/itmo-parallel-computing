# Лабораторная работа 5

## POSIX потоки

# Лабораторная №5: Параллельное программирование с использованием стандарта POSIX Threads

1. Взять в качестве исходной OpenMP-программу из ЛР-4, в которой распараллелены все этапы вычисления.
Убедиться, что в этой программе корректно реализован одновременный доступ к общей переменной,
используемой для вывода в консоль процента завершения программы.

2. Изменить исходную программу так, чтобы вместо OpenMP-директив применялся стандарт «POSIX Threads»:
- для получения оценки «3» достаточно изменить только один этап (Generate, Map, Merge, Sort),
который является узким местом (bottle neck),
а также функцию вывода в консоль процента завершения программы;
- для получения оценки «4» и «5» необходимо изменить всю программу,
но допускается в качестве расписания циклов использовать «schedule static»;
- для получения оценки «5» необходимо хотя бы один цикл распараллелить,
реализовав вручную расписание «schedule dynamic» или «schedule guided».

3. Провести эксперименты и по результатам выполнить сравнение работы
двух параллельных программ («OpenMP» и «POSIX Threads»),
которое должно описывать следующие аспекты работы обеих программ (для различных N):
- полное время решения задачи;
- параллельное ускорение;
- доля времени, проводимого на каждом этапе вычисления («нормированная диаграмма с областями и накоплением»);
- количество строк кода, добавленных при распараллеливании,
а также грубая оценка времени, потраченного на распараллеливание (накладные расходы программиста);
- остальные аспекты, которые вы выяснили самостоятельно

### Проведение эксперимента

1. Установить компилятор *clang*
```
sudo apt-get update
sudo apt-get install -y clang
```
2. Установить `Python-3.10`
3. Сборка эксперементальных билдов
```
python build.py
```

4. Запуск эксперимента и генерация графиков
```
python run.py
```

6. Создание графика на основе файла с результатами
```
python draw.py

usage: draw.py [-h] [--result-path RESULTS_PATH]

optional arguments:
  -h, --help            show this help message and exit
  --result-path RESULTS_PATH
```

7. Создание графика параллельного ускорения на основе файла с результатами
```
python calc_acc.py

usage: calc_acc.py [-h] [--target [{CLANG} [{CLANG} ...]]] [--result-path RESULTS_PATH]
                   [--default-key DEFAULT_KEY]

optional arguments:
  -h, --help            show this help message and exit
  --target [{CLANG} [{CLANG} ...]], -t [{CLANG} [{CLANG} ...]]
  --result-path RESULTS_PATH
  --default-key DEFAULT_KEY
```
